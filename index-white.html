<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- CSS -->
    <link rel="stylesheet" href="./css/index.css" />
    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.3/gsap.min.js"></script>
    <!-- 스크롤 트리거 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.3/ScrollTrigger.min.js"></script>
    <!-- jquery -->
    <script src="./js/jquery.min.js"></script>
    <!-- slick -->
    <script src="./js/slick/slick.min.js"></script>
    <link rel="stylesheet" href="./css/slick/slick.css" />
    <link rel="stylesheet" href="./css/slick/slick-theme.css" />
    <!-- lenis -->
    <script src="https://unpkg.com/@studio-freight/lenis@1.0.42/dist/lenis.min.js"></script>
    <!-- matter -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.14.2/matter.min.js"></script>
  </head>
  <body>
    <header></header>
    <main class="white">
      <section class="sec1">
        <div id="main-title">
          <h2 class="title">NEOPHARM</h2>
          <span class="sub"></span>
        </div>
        <div class="container">
          <figure class="img-box">
            <img src="./img/sec1/mockup.png" alt="목업이미지" />
          </figure>
          <figure class="bg-box">
            <div class="text">
              <img
                src="./img/sec1/weaver-portflio.svg"
                alt="위버로프트 포트폴리오 손글씨"
              />
            </div>
            <div class="line">
              <div class="wrap first">
                <div class="circle"></div>
              </div>
              <div class="wrap second">
                <div class="circle"></div>
              </div>
            </div>
          </figure>
          <div class="black-box"></div>
        </div>
      </section>
      <section class="sec2">
        <div class="container">
          <div class="text-box">
            <p>
              소아 경증환자의 응급실 과밀화를 방지하여 응급의 료자원의 효과적인
              분배를 위해 선별 가이드라인을 안내합다. 소아 경증환자의 응급실
              과밀화를 방지하 여 응급의료자원의 효과적인 분배를 위해 선별 가이
              드라인을 안내합다.
            </p>
            <p>
              소아 경증환자의 응급실 과밀화를 방지하여 응급의 료자원의 효과적인
              분배를 위해 선별 가이드라인을 안내합다. 소아 경증환자의 응급실
              과밀화를 방지하 여 응급의료자원의 효과적인 분배를 위해 선별 가이
              드라인을 안내합다.
            </p>
          </div>
          <a href="#" class="shortcut">사이트 바로가기</a>
        </div>
      </section>
      <section class="drop-key-section sec3">
        <div class="reverse-box"></div>
      </section>
      <script>
        var Engine = Matter.Engine,
          Render = Matter.Render,
          Events = Matter.Events,
          MouseConstraint = Matter.MouseConstraint,
          Mouse = Matter.Mouse,
          World = Matter.World,
          Bodies = Matter.Bodies,
          Composite = Matter.Composite,
          Body = Matter.Body;

        var engine, world, render, mouseConstraint;
        var objects = []; // 모든 오브젝트를 저장할 배열

        function createWorld() {
          engine = Engine.create({
            positionIterations: 6,
            velocityIterations: 4,
          });
          world = engine.world;

          var dropKeySection = document.querySelector(".drop-key-section");
          var sectionWidth = dropKeySection.offsetWidth;
          var sectionHeight = dropKeySection.offsetHeight;

          render = Render.create({
            element: dropKeySection,
            engine: engine,
            options: {
              width: sectionWidth,
              height: sectionHeight,
              pixelRatio: 1,
              background: "transparent",
              wireframes: false,
            },
          });

          createBoundaries();
          createObjects();

          var mouse = Mouse.create(render.canvas);
          mouseConstraint = MouseConstraint.create(engine, {
            mouse: mouse,
            constraint: {
              stiffness: 0.2,
              render: {
                visible: false,
              },
            },
          });

          World.add(world, mouseConstraint);
          render.mouse = mouse;

          Events.on(mouseConstraint, "mouseup", handleMouseUp);
          Events.on(render, "afterRender", renderText);

          Engine.run(engine);
          Render.run(render);
        }

        function createBoundaries() {
          var dropKeySection = document.querySelector(".drop-key-section");
          var sectionWidth = dropKeySection.offsetWidth;
          var sectionHeight = dropKeySection.offsetHeight;

          var ground = Bodies.rectangle(
            sectionWidth / 2,
            sectionHeight,
            sectionWidth,
            1,
            {
              render: {
                fillStyle: "#000000",
              },
              isStatic: true,
            }
          );
          var wallLeft = Bodies.rectangle(
            0,
            sectionHeight / 2,
            1,
            sectionHeight,
            {
              render: {
                fillStyle: "#000000",
              },
              isStatic: true,
            }
          );
          var wallRight = Bodies.rectangle(
            sectionWidth,
            sectionHeight / 2,
            1,
            sectionHeight,
            {
              render: {
                fillStyle: "#000000",
              },
              isStatic: true,
            }
          );
          var ceiling = Bodies.rectangle(sectionWidth / 2, 0, sectionWidth, 1, {
            render: {
              fillStyle: "#000000",
            },
            isStatic: true,
          });

          World.add(world, [ground, wallLeft, wallRight, ceiling]);
        }

        function createTextBody(x, y, width, height, fillStyle, strokeColor) {
          var body = Bodies.rectangle(x, y, width, height, {
            chamfer: {
              radius: Math.min(height / 2, 60), // height에 비례한 radius 값 설정
            },
            render: {
              fillStyle: fillStyle, // 배경 색상
              strokeStyle: strokeColor, // 외곽선 색상
              lineWidth: 2, // 선 두께
            },
            isStatic: false,
            restitution: 0.5,
            friction: 0.2,
          });

          objects.push(body);
          return body;
        }

        function createObjects() {
          objects = []; // 객체 배열 초기화
          var black = "black";
          var white = "white";
          var red = "red";

          var bodyData = [
            {
              text: "ART",
              color: black,
              strokeColor: white,
              textColor: "white",
            },
            {
              text: "3D",
              color: black,
              strokeColor: white,
              textColor: "white",
            },
            {
              text: "GRAPHIC",
              color: black,
              strokeColor: white,
              textColor: "white",
            },
            {
              text: "PHOTO",
              color: black,
              strokeColor: white,
              textColor: "white",
            },
            {
              text: "VINTAGE",
              color: white,
              strokeColor: black,
              textColor: "black",
            },
            {
              text: "SHORT",
              color: white,
              strokeColor: black,
              textColor: "black",
            },

            {
              text: "GOOD",
              color: red,
              strokeColor: white,
              textColor: "white",
            },
          ];

          var dropKeySection = document.querySelector(".drop-key-section");
          var sectionWidth = dropKeySection.offsetWidth;
          var sectionHeight = dropKeySection.offsetHeight;

          var centerX = sectionWidth / 2;
          var yStart = 50; // 화면 상단에서 시작

          bodyData.forEach((data, index) => {
            var textWidth = getTextWidth(data.text);
            var windowWidth = window.innerWidth;
            var padding = Math.min(300, Math.max(20, windowWidth * 0.1)); // 패딩 값을 추가

            var height = Math.min(80, Math.max(42, windowWidth * 0.05)); // 창 크기에 따라 조정

            var x = centerX + (Math.random() - 0.5) * 200;
            var y = yStart + index * 10;
            var body = createTextBody(
              x,
              y,
              textWidth + padding,
              height,
              data.color,
              data.strokeColor // 외곽선 색상 설정
            );
            body.text = data.text; // 텍스트를 Body에 추가 (하지만 Matter.js 자체에서 렌더링하지 않음)
            body.textColor = data.textColor; // 텍스트 색상 저장
            Body.setVelocity(body, { x: (Math.random() - 0.5) * 2, y: 2 });
          });

          World.add(world, objects);
        }

        function getTextWidth(text) {
          var canvas = document.createElement("canvas");
          var context = canvas.getContext("2d");
          return context.measureText(text).width;
        }

        function handleMouseUp(event) {
          var mouseConstraint = event.source;
          var bodies = Composite.allBodies(engine.world);
          if (!mouseConstraint.bodyB) {
            for (var i = 0; i < bodies.length; i++) {
              var body = bodies[i];
              if (
                Matter.Bounds.contains(
                  body.bounds,
                  mouseConstraint.mouse.position
                )
              ) {
                var bodyUrl = body.url;
                console.log("Body.Url >> " + bodyUrl);
                if (bodyUrl != undefined) {
                  window.open(bodyUrl, "_blank");
                  console.log("Hyperlink was opened");
                }
                break;
              }
            }
          }
        }

        function renderText() {
          var context = render.context;
          var bodies = Composite.allBodies(engine.world);

          var windowWidth = window.innerWidth;
          var fontSize = Math.min(38, Math.max(14, windowWidth * 0.02)); // 반응형 폰트 크기 설정

          context.textAlign = "center";
          context.textBaseline = "middle";

          for (var i = 0; i < bodies.length; i++) {
            var body = bodies[i];
            if (body.text) {
              var centerX = body.position.x;
              var centerY = body.position.y;

              context.save();
              context.translate(centerX, centerY);
              context.rotate(body.angle);

              context.fillStyle = body.textColor || "white"; // 텍스트 색상
              context.font = `500 ${fontSize}px Pretendard Variable`; // 폰트 설정
              context.fillText(body.text, 0, 0); // 텍스트 출력
              context.restore();
            }
          }
        }

        function resizeCanvas() {
          // 기존 엔진, 렌더러, 월드 제거
          World.clear(world);
          Engine.clear(engine);
          Render.stop(render);
          render.canvas.remove();
          render.canvas = null;
          render.context = null;
          render.textures = {};

          // 새로운 월드 생성
          createWorld();
        }

        createWorld();

        // window.addEventListener('resize', resizeCanvas);
        var timer = null;
        $(window).on("load onorientationchange resize", function (e) {
          clearTimeout(timer);
          timer = setTimeout(resizeM, 100); //화면 변경이 끝난후 0.1s뒤에 작동
        });

        function resizeM() {
          resizeCanvas();
        }
      </script>
      <section class="sec4">
        <div class="img-box">
          <div class="first"></div>
          <div class="second"></div>
        </div>
        <div class="reverse-box"></div>
      </section>
      <section class="sec5">
        <div class="container">
          <div class="visual-box">
            <div class="slider main">
              <div class="slider-content color">
                <div class="main-box">
                  <i></i>
                  <i></i>
                  <i></i>
                </div>
                <span class="sub-title">THEME COLORS</span>
                <div class="sub-box">
                  <div class="up">
                    <span class="first"
                      ><strong>PRIMARY</strong>&nbsp;#E00719 R224 G7 B25</span
                    >
                    <span class="second"
                      ><strong>SECONDARY</strong>&nbsp;#FFAEDE R255 G174
                      B222</span
                    >
                  </div>
                  <div class="down">
                    <span class="third"
                      ><strong>SUB1</strong>&nbsp;#E00719 R224 G7 B25</span
                    >
                    <span class="fourth"
                      ><strong>SUB2</strong>&nbsp;#FFAEDE R255 G174 B222</span
                    >
                  </div>
                </div>
              </div>
              <div class="slider-content text">
                <div class="main-box">
                  <span>가</span>
                  <span>나</span>
                  <span>다</span>
                </div>
                <span class="sub-title">국문 영문 혼용</span>
                <div class="sub-box">
                  <div class="up">
                    <span class="first">가나다라마바사아자차카타파하</span>
                  </div>
                  <div class="middle">
                    <span class="first">ABCDEFGHIJKLMNOPQRSTUVWYZ</span>
                  </div>
                  <div class="down">
                    <span class="first">abcdefghijklmnopqrstuvwyz</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="slider sub1">
            <div class="text-box">
              <span class="category">COLOR</span>
              <h3>NEOPHARM RED</h3>
              <p>
                소아 경증환자의 응급실 과밀화를 방지하여 응급의료자원의<br />
                효과적인 분배를 위해 선별 가이드라인을 안내합다.
              </p>
            </div>
            <div class="text-box">
              <span class="category">FONT</span>
              <h3>PRETENDARD</h3>
              <p>
                환경 보호를 위해 일상에서 실천할 수 있는 간단한 방법들을<br />
                안내하여 지속 가능한 생활을 독려합니다.
              </p>
            </div>
          </div>
        </div>
      </section>
      <section class="sec6 pc">
        <div class="device-container">
          <figure>
            <div class="fake-img"></div>
          </figure>
        </div>
        <div class="container">
          <div class="mobile-box first">
            <div class="detail">
              <span class="category">DETAIL2</span>
              <p>
                아이아파는 서울대학교병원 소아응급의학과 의료진이<br />
                응급실 과밀화를 방지하여 가이드라인을 안내합니다.
              </p>
            </div>
          </div>
          <div class="mobile-box second"></div>
          <div class="mobile-box third">
            <div class="detail">
              <span class="category">DETAIL1</span>
              <p>
                아이아파는 서울대학교병원 소아응급의학과 의료진이<br />
                응급실 과밀화를 방지하여 가이드라인을 안내합니다.
              </p>
            </div>
          </div>
        </div>
        <div class="bg-box">
          <img src="./img/sec6/w-logo.svg" alt="w로고" />
        </div>
      </section>
      <section class="sec6 mob">
        <div class="container">
          <div class="img-area first"></div>
          <div class="img-area second"></div>
          <div class="img-area third"></div>
        </div>
      </section>
      <section class="sec7 pc">
        <div class="container">
          <ul class="items">
            <li class="item">
              <div></div>
            </li>
            <li class="item">
              <div></div>
            </li>
            <li class="item">
              <div></div>
            </li>
            <li class="item">
              <div></div>
            </li>
          </ul>
        </div>
        <div class="bg-box"></div>
      </section>
      <section class="sec7 mob">
        <div class="container">
          <div class="img-area first"></div>
          <div class="img-area second"></div>
          <div class="img-area third"></div>
          <div class="img-area fourth"></div>
        </div>
      </section>
      <section class="sec8 pc">
        <div class="container">
          <div class="solution first">
            <span class="category">PROBLEM1</span>
            <div class="be-box">
              <p>
                <strong>복잡한 레이아웃</strong>때문에<br />
                정보에 접근하기가 어려움
              </p>
            </div>
            <img class="arrow" src="./img/sec8/arrow.svg" alt="arrow" />
            <div class="af-box">
              <p>친절한 인터페이스</p>
            </div>
          </div>
          <div class="solution second">
            <span class="category">PROBLEM2</span>
            <div class="be-box">
              <p>
                사용자 경험이 저해되어<br />
                <strong>정보를 찾기 힘듬</strong>
              </p>
            </div>
            <img class="arrow" src="./img/sec8/arrow.svg" alt="arrow" />
            <div class="af-box">
              <p>효율적인 마크업</p>
            </div>
          </div>
          <div class="solution third">
            <span class="category">PROBLEM3</span>
            <div class="be-box">
              <p>
                <strong>어려운 디자인</strong>으로 인해<br />
                필요한 정보를 쉽게 찾을 수 없음
              </p>
            </div>
            <img class="arrow" src="./img/sec8/arrow.svg" alt="arrow" />
            <div class="af-box">
              <p>심플한 레이아웃</p>
            </div>
          </div>
        </div>
      </section>
      <section class="sec8 mob">
        <div class="container">
          <div class="solution first">
            <span class="category">PROBLEM1</span>
            <div class="be-box">
              <p>
                <strong>복잡한 레이아웃</strong>때문에<br />
                정보에 접근하기가 어려움
              </p>
            </div>
            <img src="./img/sec8/arrow.svg" alt="arrow" />
            <div class="af-box">
              <p>친절한 인터페이스</p>
            </div>
          </div>
          <div class="solution second">
            <span class="category">PROBLEM2</span>
            <div class="be-box">
              <p>
                사용자 경험이 저해되어<br />
                <strong>정보를 찾기 힘듬</strong>
              </p>
            </div>
            <img src="./img/sec8/arrow.svg" alt="arrow" />
            <div class="af-box">
              <p>효율적인 마크업</p>
            </div>
          </div>
          <div class="solution third">
            <span class="category">PROBLEM3</span>
            <div class="be-box">
              <p>
                <strong>어려운 디자인</strong>으로 인해<br />
                필요한 정보를 쉽게 찾을 수 없음
              </p>
            </div>
            <img src="./img/sec8/arrow.svg" alt="arrow" />
            <div class="af-box">
              <p>심플한 레이아웃</p>
            </div>
          </div>
        </div>
      </section>
      <section class="sec9">
        <div class="container">
          <img src="./img/sec9/3d임시.png" alt="3d임시" />
          <h3>FIND A AWAY</h3>
          <p>불가능한 것은 없습니다. 단지 방법을 찾지 못한 것일 뿐입니다.</p>
        </div>
        <div class="black-bg"></div>
      </section>
    </main>
    <footer>
      <div class="up">
        <a class="left" href="#">
          <span><strong>PREV</strong>위버로프트</span>
        </a>
        <a class="middle" href="#"></a>
        <a href="#" class="right">
          <span><strong>NEXT</strong>위버로프트</span></a
        >
      </div>
      <div class="down"></div>
    </footer>
    <script src="./js/index-white.js"></script>
    <script src="./js/common.js"></script>
  </body>
</html>
